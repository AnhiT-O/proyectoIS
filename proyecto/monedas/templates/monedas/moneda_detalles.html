{% extends 'base.html' %}
{% load static %}
{% load humanize %}

{% block title %}{{ moneda.nombre }} - Global Exchange{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'claro/detalles.css' %}" media="(prefers-color-scheme: light)">
<link rel="stylesheet" href="{% static 'oscuro/detalles.css' %}" media="(prefers-color-scheme: dark)">
{% endblock %}

{% block content %}
<div class="contenido">
    <div class="detalle-cabecera">
        <h1 class="detalle-nombre">
            💰 {{ moneda.nombre }}
        </h1>
        <div class="detalle-tipo">
            {{ moneda.simbolo }}
        </div>
    </div>

    <div class="zona-detalle">
        <div class="seccion-info">
            <!-- Información Básica -->
            <div class="info-columna">
                <div class="info-celda">
                    <span class="info-icono">🔢</span>
                    <div class="info-contenido">
                        <div class="info-titulo">Símbolo</div>
                        <div class="info-valor">{{ moneda.simbolo }}</div>
                    </div>
                </div>
                <div class="info-celda">
                    <span class="info-icono">📊</span>
                    <div class="info-contenido">
                        <div class="info-titulo">Stock Disponible</div>
                        <div class="info-valor">{{ moneda.stock|intcomma }}</div>
                    </div>
                </div>
                <div class="info-celda">
                    <span class="info-icono">🔒</span>
                    <div class="info-contenido">
                        <div class="info-titulo">Estado</div>
                        <div class="info-valor">
                            {% if moneda.activa %}
                                <span class="etiqueta-activo">
                                    Activa
                                </span>
                            {% else %}
                                <span class="etiqueta-bloqueado">
                                    Inactiva
                                </span>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Información de Comisiones y Estado -->
            <div class="info-columna">
                <div class="info-celda">
                    <span class="info-icono">💹</span>
                    <div class="info-contenido">
                        <div class="info-titulo">Tasa Base</div>
                        <div class="info-valor">Gs. {{ moneda.tasa_base|intcomma }}</div>
                    </div>
                </div>
                <div class="info-celda">
                    <span class="info-icono">💲</span>
                    <div class="info-contenido">
                        <div class="info-titulo">Comisión de Compra</div>
                        <div class="info-valor">Gs. {{ moneda.comision_compra|intcomma }}</div>
                    </div>
                </div>
                <div class="info-celda">
                    <span class="info-icono">💰</span>
                    <div class="info-contenido">
                        <div class="info-titulo">Comisión de Venta</div>
                        <div class="info-valor">Gs. {{ moneda.comision_venta|intcomma }}</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Información Adicional -->
        <div class="info-columna" style="grid-column: 1 / -1;">
            <div class="info-celda">
                <span class="info-icono">⚙️</span>
                <div class="info-contenido">
                    <div class="info-titulo">Configuración de Visualización</div>
                    <div class="info-valor">
                        <div class="lista-clientes">
                            <div class="cliente">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <strong>Decimales a Mostrar</strong>
                                        <br>
                                        <small style="color: #6c757d;">
                                            Cantidad de decimales que se mostrarán en la interfaz
                                        </small>
                                    </div>
                                    <div style="font-size: 1.5rem; font-weight: bold;">
                                        {{ moneda.decimales }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div style="height: 2rem;"></div>
        <!-- Cálculos de Precios -->
        <div class="info-columna" style="grid-column: 1 / -1;">
            <div class="info-celda">
                <span class="info-icono">📈</span>
                <div class="info-contenido">
                    <div class="info-titulo">Precios de Operación</div>
                    <div class="info-valor">
                        <div class="lista-clientes">
                            <div class="cliente">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                    <div>
                                        <strong>Precio de Compra</strong>
                                        <br>
                                        <small style="color: #6c757d;">
                                            Tasa base - Comisión de compra
                                        </small>
                                    </div>
                                    <div style="font-size: 1.2rem; font-weight: bold">
                                        Gs. {{ moneda.calcular_precio_compra|intcomma }}
                                    </div>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <strong>Precio de Venta</strong>
                                        <br>
                                        <small style="color: #6c757d;">
                                            Tasa base + Comisión de venta
                                        </small>
                                    </div>
                                    <div style="font-size: 1.2rem; font-weight: bold">
                                        Gs. {{ moneda.calcular_precio_venta|intcomma }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="zona-acciones">
        <div class="acciones-contenido">
            {% if perms.monedas.gestion or perms.monedas.cotizacion %}
                <a href="{% url 'monedas:editar_monedas' moneda.pk %}" class="btn-primario">
                    Editar Moneda
                </a>
            {% endif %}
            
            <a href="{% url 'monedas:lista_monedas' %}" class="btn-secundario">
                Volver a la Lista
            </a>
        </div>
    </div>
</div>
{% endblock %}