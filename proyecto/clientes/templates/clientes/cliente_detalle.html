{% extends 'base.html' %}
{% load static %}

{% block title %}{{ cliente.nombre }} - Global Exchange{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'claro/detalles.css' %}" media="(prefers-color-scheme: light)">
<link rel="stylesheet" href="{% static 'oscuro/detalles.css' %}" media="(prefers-color-scheme: dark)">
{% endblock %}

{% block content %}
<div class="contenido">
    <div class="detalle-cabecera">
        <h1 class="detalle-nombre">
                {{ cliente.nombre }}
        </h1>
        <div class="detalle-tipo">
            {{ cliente.get_tipoCliente_display }}
        </div>
    </div>

    <div class="zona-detalle">
        <div class="seccion-info">
            <!-- InformaciÃ³n Personal -->
            <div class="info-columna">
                <div class="info-celda">
                    <span class="info-icono">ğŸ“„</span>
                    <div class="info-contenido">
                        <div class="info-titulo">Tipo de Documento</div>
                        <div class="info-valor">{{ cliente.get_tipoDocCliente_display }}</div>
                    </div>
                </div>
                <div class="info-celda">
                    <span class="info-icono">ğŸ”¢</span>
                    <div class="info-contenido">
                        <div class="info-titulo">NÃºmero de Documento</div>
                        <div class="info-valor">{{ cliente.docCliente }}</div>
                    </div>
                </div>
                <div class="info-celda">
                    <span class="info-icono">ğŸ·ï¸</span>
                    <div class="info-contenido">
                        <div class="info-titulo">Segmento</div>
                        <div class="info-valor">{{ cliente.get_segmento_display }}</div>
                    </div>
                </div>
                <div class="info-celda">
                    <span class="info-icono">ğŸ</span>
                    <div class="info-contenido">
                        <div class="info-titulo">Beneficio aplicado</div>
                        <div class="info-valor">
                            {% if cliente.beneficio_segmento > 0 %}
                                {{ cliente.beneficio_segmento }}%
                            {% else %}
                                Ninguno
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- InformaciÃ³n de Contacto -->
            <div class="info-columna">
                <div class="info-celda">
                    <span class="info-icono">ğŸ“§</span>
                    <div class="info-contenido">
                        <div class="info-titulo">Correo ElectrÃ³nico</div>
                        <div class="info-valor">{{ cliente.correoElecCliente }}</div>
                    </div>
                </div>
                <div class="info-celda">
                    <span class="info-icono">ğŸ“</span>
                    <div class="info-contenido">
                        <div class="info-titulo">TelÃ©fono</div>
                        <div class="info-valor">{{ cliente.telefono }}</div>
                    </div>
                </div>
                <div class="info-celda">
                    <span class="info-icono">ğŸ </span>
                    <div class="info-contenido">
                        <div class="info-titulo">Domicilio</div>
                        <div class="info-valor">{{ cliente.direccion|default:"No especificado" }}</div>
                    </div>
                </div>
                <div class="info-celda">
                    <span class="info-icono">ğŸ’¼</span>
                    <div class="info-contenido">
                        <div class="info-titulo">OcupaciÃ³n</div>
                        <div class="info-valor">{{ cliente.ocupacion|default:"No especificada" }}</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Estado de DeclaraciÃ³n Jurada -->
        <div class="info-columna" style="grid-column: 1 / -1;">
            <div class="info-celda">
                <span class="info-icono">ğŸ“</span>
                <div class="info-contenido">
                    <div class="info-titulo">Estado de DeclaraciÃ³n Jurada</div>
                    <div class="info-valor">
                        {% if cliente.declaracion_jurada %}
                            <span class="etiqueta-activo">
                                DeclaraciÃ³n Firmada
                            </span>
                        {% else %}
                            <span class="etiqueta-bloqueado">
                                DeclaraciÃ³n Pendiente
                            </span>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SecciÃ³n de Medios de AcreditaciÃ³n -->
    <div class="zona-detalle" style="margin-top: 2rem;">
        <div class="detalle-cabecera" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
            <h2 style="margin: 0; color: var(--color-texto-principal); font-size: 1.5rem;">Medios de AcreditaciÃ³n</h2>
            <div style="display: flex; gap: 0.5rem;">
                                <!-- BotÃ³n para agregar cuenta bancaria -->
                <a href="{% url 'clientes:cliente_agregar_cuenta_bancaria' cliente.pk %}" class="btn-primario" style="font-size: 0.9rem; padding: 0.5rem 1rem; border: 2px solid white; color: white;">
                    + Agregar Cuenta Bancaria
                </a>
                <a href="{% url 'clientes:cliente_agregar_billetera' cliente.pk %}" class="btn-primario" style="font-size: 0.9rem; padding: 0.5rem 1rem; border: 2px solid white; color: white;">
                    + Agregar Billetera
                </a>
            </div>
        </div>

        {% if cuentas_bancarias or billeteras %}
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                <!-- Cuentas Bancarias -->
                {% for cuenta in cuentas_bancarias %}
                <div class="info-celda" style="border-left: 4px solid #007bff; background: var(--color-fondo-tarjeta); border-radius: 8px; padding: 1rem; display: flex; flex-direction: column;">
                    <div style="display: flex; align-items: center; margin-bottom: 1rem;">
                        <span style="font-size: 1.5rem; margin-right: 0.5rem;">ğŸ¦</span>
                        <div style="flex: 1;">
                            <div class="info-titulo">Cuenta Bancaria</div>
                        </div>
                    </div>
                    
                    <!-- InformaciÃ³n detallada -->
                    <div style="color: var(--color-texto-secundario); font-size: 0.875rem; line-height: 1.4; margin-bottom: 1rem;">
                        <div style="margin-bottom: 0.25rem;"><strong>Banco:</strong> {{ cuenta.get_banco_display }}</div>
                        <div style="margin-bottom: 0.25rem;"><strong>Cuenta:</strong> {{ cuenta.numero_cuenta }}</div>
                        <div><strong>Titular:</strong> {{ cuenta.nombre_titular }}</div>
                    </div>
                    
                    <!-- BotÃ³n Eliminar -->
                    <div>
                        <form method="post" action="{% url 'clientes:cliente_eliminar_medio_acreditacion' cliente.pk 'cuenta' cuenta.id %}" onsubmit="return confirm('Â¿EstÃ¡ seguro de que desea eliminar esta cuenta bancaria?');" style="display: inline;">
                            {% csrf_token %}
                            <button type="submit" class="btn-desactivar" style="font-size: 0.8rem; padding: 0.4rem 0.8rem;">
                                Eliminar
                            </button>
                        </form>
                    </div>
                </div>
                {% endfor %}

                <!-- Billeteras -->
                {% for billetera in billeteras %}
                <div class="info-celda" style="border-left: 4px solid #ffc107; background: var(--color-fondo-tarjeta); border-radius: 8px; padding: 1rem; display: flex; flex-direction: column;">
                    <div style="display: flex; align-items: center; margin-bottom: 1rem;">
                        <span style="font-size: 1.5rem; margin-right: 0.5rem;">ğŸ’³</span>
                        <div style="flex: 1;">
                            <div class="info-titulo">Billetera ElectrÃ³nica</div>
                        </div>
                    </div>
                    
                    <!-- InformaciÃ³n detallada -->
                    <div style="color: var(--color-texto-secundario); font-size: 0.875rem; line-height: 1.4; margin-bottom: 1rem;">
                        <div style="margin-bottom: 0.25rem;"><strong>Tipo:</strong> {{ billetera.get_tipo_billetera_display }}</div>
                        <div style="margin-bottom: 0.25rem;"><strong>NÃºmero:</strong> {{ billetera.numero_billetera }}</div>
                        <div style="margin-bottom: 0.25rem;"><strong>Titular:</strong> {{ billetera.nombre_titular }}</div>
                        <div><strong>CI:</strong> {{ billetera.ci }}</div>
                    </div>
                    
                    <!-- BotÃ³n Eliminar -->
                    <div>
                        <form method="post" action="{% url 'clientes:cliente_eliminar_medio_acreditacion' cliente.pk 'billetera' billetera.id %}" onsubmit="return confirm('Â¿EstÃ¡ seguro de que desea eliminar esta billetera?');" style="display: inline;">
                            {% csrf_token %}
                            <button type="submit" class="btn-desactivar" style="font-size: 0.8rem; padding: 0.4rem 0.8rem;">
                                Eliminar
                            </button>
                        </form>
                    </div>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div style="text-align: center; padding: 2rem; background: var(--color-fondo-tarjeta); border-radius: 8px; border: 1px solid var(--color-borde);">
                <span style="font-size: 3rem; opacity: 0.5;">ğŸ’°</span>
                <h3 style="color: var(--color-texto-secundario); margin: 1rem 0 0.5rem 0;">Sin medios de acreditaciÃ³n</h3>
                <p style="color: var(--color-texto-secundario); margin: 0;">Este cliente no tiene medios de acreditaciÃ³n configurados.</p>
            </div>
        {% endif %}
    </div>

    <div class="zona-acciones">
        <div class="acciones-contenido">
            <a href="{% url 'clientes:cliente_editar' cliente.pk %}" class="btn-primario">
                Editar Cliente
            </a>
            <a href="{% url 'clientes:cliente_lista' %}" class="btn btn-secundario">
                Volver a la Lista
            </a>
        </div>
    </div>
</div>

{% endblock %}