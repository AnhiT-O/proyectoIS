{% extends 'base.html' %}
{% load static %}

{% block title %}Detalle del Cliente - Global Exchange{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'claro/perfil.css' %}" media="(prefers-color-scheme: light)">
<link rel="stylesheet" href="{% static 'oscuro/perfil.css' %}" media="(prefers-color-scheme: dark)">
{% endblock %}

{% block content %}
<div class="contenido">
    <div class="cabecera-perfil">
        <div class="logo"></div>
        <h1 class="titulo">Detalle del Cliente</h1>
        <p class="subtitulo">Informaci贸n completa del cliente {{ cliente.nombre }}</p>
    </div>

    <div class="zona-perfil">
        <div class="perfil-info">
            <h2 class="perfil-titulo">Informaci贸n Personal</h2>
            <div class="info-campos">
                <div class="info-campo">
                    <div class="info-titulo">Nombre Completo</div>
                    <div class="info-valor">{{ cliente.nombre }}</div>
                </div>
                <div class="info-campo">
                    <div class="info-titulo">Tipo de Cliente</div>
                    <div class="info-valor">{{ cliente.get_tipoCliente_display }}</div>
                </div>
                <div class="info-campo">
                    <div class="info-titulo">Correo Electr贸nico</div>
                    <div class="info-valor">{{ cliente.correoElecCliente }}</div>
                </div>
                <div class="info-campo">
                    <div class="info-titulo">Tel茅fono</div>
                    <div class="info-valor">{{ cliente.telefono }}</div>
                </div>
                <div class="info-campo">
                    <div class="info-titulo">Tipo de Documento</div>
                    <div class="info-valor">{{ cliente.get_tipoDocCliente_display }}</div>
                </div>
                <div class="info-campo">
                    <div class="info-titulo">N煤mero de Documento</div>
                    <div class="info-valor">{{ cliente.docCliente }}</div>
                </div>
                <div class="info-campo">
                    <div class="info-titulo">Direcci贸n</div>
                    <div class="info-valor">{{ cliente.direccion }}</div>
                </div>
                <div class="info-campo">
                    <div class="info-titulo">Ocupaci贸n</div>
                    <div class="info-valor">{{ cliente.ocupacion }}</div>
                </div>
                <div class="info-campo">
                    <div class="info-titulo">Segmento</div>
                    <div class="info-valor">{{ cliente.get_segmento_display }}</div>
                </div>
                <div class="info-campo">
                    <div class="info-titulo">Declaraci贸n Jurada</div>
                    <div class="info-valor">
                        {% if cliente.declaracion_jurada %}
                            <span class="etiqueta-activo">Firmada</span>
                        {% else %}
                            <span class="etiqueta-bloqueado">Pendiente</span>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Secci贸n de Medios de Acreditaci贸n -->
        <div class="perfil-info" style="margin-top: 2rem;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <h2 class="perfil-titulo">Medios de Acreditaci贸n</h2>
                <div style="display: flex; gap: 0.5rem;">
                    <a href="{% url 'clientes:cliente_agregar_cuenta_bancaria' cliente.pk %}" class="btn-secundario" style="font-size: 0.9rem; padding: 0.5rem 1rem;">
                        Agregar Cuenta Bancaria
                    </a>
                    <a href="{% url 'clientes:cliente_agregar_billetera' cliente.pk %}" class="btn-secundario" style="font-size: 0.9rem; padding: 0.5rem 1rem;">
                        Agregar Billetera
                    </a>
                </div>
            </div>

            {% if cuentas_bancarias or billeteras %}
                <div class="info-campos">
                    <!-- Cuentas Bancarias -->
                    {% for cuenta in cuentas_bancarias %}
                    <div class="info-campo">
                        <div style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                            <!--<span style="font-size: 1.5rem; margin-right: 0.5rem;"></span>-->
                            <div style="flex: 1;">
                                <div class="info-titulo">Cuenta Bancaria</div>
                            </div>
                            <form method="post" action="{% url 'clientes:cliente_eliminar_medio_acreditacion' cliente.pk 'cuenta' cuenta.id %}" 
                                  onsubmit="return confirm('驴Est谩s seguro de eliminar esta cuenta bancaria?');" style="display: inline;">
                                {% csrf_token %}
                                <button type="submit" class="btn-desactivar" style="font-size: 0.8rem; padding: 0.3rem 0.8rem;">
                                    Eliminar
                                </button>
                            </form>
                        </div>
                        <div class="info-valor">
                            <strong>Banco:</strong> {{ cuenta.get_banco_display }}<br>
                            <strong>N煤mero:</strong> {{ cuenta.numero_cuenta }}<br>
                            <strong>Titular:</strong> {{ cuenta.nombre_titular }}<br>
                            <strong>Documento:</strong> {{ cuenta.nro_documento }}
                        </div>
                    </div>
                    {% endfor %}

                    <!-- Billeteras -->
                    {% for billetera in billeteras %}
                    <div class="info-campo">
                        <div style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                            <!--<span style="font-size: 1.5rem; margin-right: 0.5rem;"></span>-->
                            <div style="flex: 1;">
                                <div class="info-titulo">{{ billetera.get_tipo_billetera_display }}</div>
                            </div>
                            <form method="post" action="{% url 'clientes:cliente_eliminar_medio_acreditacion' cliente.pk 'billetera' billetera.id %}" 
                                  onsubmit="return confirm('驴Est谩s seguro de eliminar esta billetera?');" style="display: inline;">
                                {% csrf_token %}
                                <button type="submit" class="btn-desactivar" style="font-size: 0.8rem; padding: 0.3rem 0.8rem;">
                                    Eliminar
                                </button>
                            </form>
                        </div>
                        <div class="info-valor">
                            <strong>Tel茅fono:</strong> {{ billetera.telefono }}<br>
                            <strong>Titular:</strong> {{ billetera.nombre_titular }}<br>
                            <strong>Documento:</strong> {{ billetera.nro_documento }}
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div style="text-align: center; padding: 2rem; background: var(--color-fondo-tarjeta); border-radius: 8px; border: 1px solid var(--color-borde);">
                    <span style="font-size: 3rem; opacity: 0.5;"></span>
                    <h3 style="color: var(--color-texto-secundario); margin: 1rem 0 0.5rem 0;">Sin medios de acreditaci贸n</h3>
                    <p style="color: var(--color-texto-secundario); margin: 0;">Este cliente no tiene medios de acreditaci贸n asociados.</p>
                </div>
            {% endif %}
        </div>

    <div class="zona-acciones">
        <a href="{% url 'usuarios:mis_clientes' %}" class="btn-secundario">
            Volver a Mis Clientes
        </a>
    </div>
    </div>
</div>

{% endblock %}