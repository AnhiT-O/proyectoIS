{% extends 'base.html' %}
{% load static %}

{% block title %}Asignar Clientes - Global Exchange{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'formularios.css' %}">
{% endblock %}

{% block content %}
<div class="contenido">
    <div class="form-cabecera">
        <h2>Asignar Clientes a Usuario</h2>
    </div>
    <div class="info-usuario">
        <p><strong>Nombre del Usuario:</strong> {{ usuario.get_full_name }}</p>
    </div>

    <form method="post" novalidate>
        {% csrf_token %}
        
        <p class="subtitulo">Marca los clientes que deseas asignar a este usuario:</p>

        {% if form.clientes.field.queryset.exists %}
            <div class="zona-tarjetas">
                {% for cliente in form.clientes.field.queryset %}
                    <div class="tarjeta">
                            <input class="form-casilla" type="checkbox" name="clientes" value="{{ cliente.pk }}" id="cliente_{{ cliente.pk }}">
                            <label class="form-casilla-label" for="cliente_{{ cliente.pk }}">
                                <strong>{{ cliente.nombre }} {{ cliente.apellido }} ({{ cliente.docCliente }})</strong>
                            </label>
                        <div class="tarjeta-detalles">
                            Email: {{ cliente.correoElecCliente }}<br>
                            Teléfono: {{ cliente.telefono }}<br>
                            Tipo: {% if cliente.tipoCliente == 'F' %}Persona Física{% else %}Persona Jurídica{% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>

            <div class="zona-botones">
                    <button type="submit" class="btn-enviar">Asignar</button>
                    <a href="{% url 'usuarios:administrar_usuarios' %}" class="btn-atras">Cancelar</a>
            </div>
        {% endif %}
    </form>
</div>

<script>
    // Agregar efecto visual al seleccionar clientes
    document.addEventListener('DOMContentLoaded', function() {
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        
        checkboxes.forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                const card = this.closest('.tarjeta');
                if (this.checked) {
                    card.classList.add('selected');
                } else {
                    card.classList.remove('selected');
                }
            });
        });
    });
</script>
{% endblock %}
